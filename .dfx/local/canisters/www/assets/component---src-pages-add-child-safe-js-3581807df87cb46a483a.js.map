{"version":3,"sources":["webpack://doocoins/./src/pages/add_child_safe.js"],"names":["Main","styled","ProfilePicture","React","image","setImage","actor","setActor","then","module","default","onSubmit","e","preventDefault","card","vCard","inputs","target","querySelectorAll","email","querySelector","value","forEach","input","name","names","split","arr","Array","reverse","idx","add","join","btoa","mediatype","set","JSON","stringify","toJSON","alert","htmlFor","type","autoComplete","required","id","accept","onChange","file","files","reader","FileReader","addEventListener","result","readAsDataURL","src","alt"],"mappings":"uJAKMA,EAAOC,qBAAH,+DAAGA,CAAH,sMAiBJC,EAAiBD,wBAAH,yEAAGA,CAAH,+CAQHA,mBAAH,mEAAGA,CAAH,2KAiId,UA5Gc,WACZ,MAA0BE,WAAe,IAAlCC,EAAP,KAAcC,EAAd,KACA,EAAwBF,WAAe,MACvC,GADA,UAC0BA,WAAe,OAAlCG,EAAP,KAAcC,EAAd,KAgEA,OA9DAJ,aAAgB,WACd,8BAAmBK,MAAK,SAACC,GACvBF,EAASE,EAAOC,cAEjB,IA2DD,gBAACV,EAAD,KACE,uDACA,yCAGA,wBAAMW,SA9DV,SAAsBC,GACpBA,EAAEC,iBAEF,IAAMC,EAAO,IAAIC,KACXC,EAASJ,EAAEK,OAAOC,iBAAiB,SACnCC,EAAQP,EAAEK,OAAOG,cAAc,uBAAuBC,MA4B5D,OA3BAL,EAAOM,SAAQ,SAACC,GACd,GAAmB,UAAfA,EAAMC,KACL,GAAmB,MAAfD,EAAMC,KAAc,CAE3B,IAAMC,EAAQF,EAAMF,MAAMK,MAAM,KAC1BC,EAAM,IAAIC,MAAM,GAEtBH,EAAMI,UAAUP,SAAQ,SAACE,EAAMM,GAC7BH,EAAIG,GAAON,KAGbV,EAAKiB,IAAI,KAAMR,EAAMF,OACrBP,EAAKiB,IAAIR,EAAMC,KAAMG,EAAIK,KAAK,WAE9BlB,EAAKiB,IAAIR,EAAMC,KAAMD,EAAMF,UAG/BP,EAAKiB,IAAI,QAASE,KAAK7B,GAAQ,CAAE8B,UAAW,cAE5C5B,WAAO6B,IAAIhB,EAAOiB,KAAKC,UAAUvB,EAAKwB,WAAW9B,MAAK,WACpD+B,MAAM,gBACNvB,EAAOM,SAAQ,SAACC,GACdA,EAAMF,MAAQ,MAEhBhB,EAAS,QAGJ,IAgCD,yBAAOmC,QAAQ,KAAf,OAEE,yBAAOC,KAAK,OAAOjB,KAAK,IAAIkB,aAAa,UAE3C,2BACA,yBAAOF,QAAQ,SAAf,QAEE,yBAAOG,UAAQ,EAACF,KAAK,QAAQjB,KAAK,QAAQkB,aAAa,WAEzD,2BACA,yBAAOF,QAAQ,SAAf,kBAEE,yBACEC,KAAK,OACLG,GAAG,MACHpB,KAAK,QACLqB,OAAO,UACPC,SA9CZ,SAAsBlC,GACpB,IAAMmC,EAAOnC,EAAEK,OAAO+B,MAAM,GACtBC,EAAS,IAAIC,WAEnBD,EAAOE,iBACL,QACA,WAEE9C,EAAS4C,EAAOG,WAElB,GAGEL,GACFE,EAAOI,cAAcN,OAmChB3C,EACC,gBAACF,EAAD,KACE,uBAAKoD,IAAKlD,EAAOmD,IAAI,iCAErB,KACJ,2BACF,0BAAQd,KAAK,UAAb","file":"component---src-pages-add-child-safe-js-3581807df87cb46a483a.js","sourcesContent":["import * as React from \"react\";\nimport styled from \"styled-components\";\nimport vCard from \"vcf\";\n\n// styles\nconst Main = styled.main`\n  color: \"#232129\";\n  padding: 96;\n  font-family: \"-apple-system, Roboto, sans-serif, serif\";\n  width: fit-content;\n\n  fieldset,\n  label {\n    display: flex;\n    flex-direction: column;\n  }\n  input {\n    min-width: 280px;\n    width: fit-content;\n  }\n`;\n\nconst ProfilePicture = styled.picture`\n  display: flex;\n  width: 256px;\n  img {\n    width: 100%;\n  }\n`;\n\nconst DataList = styled.dl`\n  display: grid;\n  grid-template-columns: auto auto;\n  dt,\n  dd {\n    /* width: fit-content; */\n    display: inline-flex;\n    border: 1px solid black;\n    padding: 4px;\n    margin: 0;\n    padding-right: 16px;\n  }\n  picture,\n  image {\n    max-width: 75px;\n  }\n`;\n\n\n\n// markup\nconst Child = () => {\n  const [image, setImage] = React.useState(\"\");\n  const [card, setCard] = React.useState(null);\n  const [actor, setActor] = React.useState(null);\n\n  React.useEffect(() => {\n    import(\"../actor\").then((module) => {\n      setActor(module.default);\n    });\n  }, []);\n\n  function handleSubmit(e) {\n    e.preventDefault();\n\n    const card = new vCard();\n    const inputs = e.target.querySelectorAll(\"input\");\n    const email = e.target.querySelector('input[name=\"email\"]').value;\n    inputs.forEach((input) => {\n      if (input.name === \"photo\") return;\n      else if (input.name === \"n\") {\n        // Take full input and format for vcf\n        const names = input.value.split(\" \");\n        const arr = new Array(5);\n\n        names.reverse().forEach((name, idx) => {\n          arr[idx] = name;\n        });\n\n        card.add(\"fn\", input.value);\n        card.add(input.name, arr.join(\";\"));\n      } else {\n        card.add(input.name, input.value);\n      }\n    });\n    card.add(\"photo\", btoa(image), { mediatype: \"image/gif\" });\n\n    actor?.set(email, JSON.stringify(card.toJSON())).then(() => {\n      alert(\"Child Added!\");\n      inputs.forEach((input) => {\n        input.value = \"\";\n      });\n      setImage(\"\");\n    });\n\n    return false;\n  }\n\n  function handleUpload(e) {\n    const file = e.target.files[0];\n    const reader = new FileReader();\n\n    reader.addEventListener(\n      \"load\",\n      function () {\n        // convert image file to base64 string\n        setImage(reader.result);\n      },\n      false\n    );\n\n    if (file) {\n      reader.readAsDataURL(file);\n    }\n  }\n\n\n\n  return (\n    <Main>\n      <title>DooCoins - Add a Child</title>\n      <h1>Add a Child</h1>\n\n\n      <form onSubmit={handleSubmit}>\n\n\n          <label htmlFor=\"n\">\n            Name\n            <input type=\"text\" name=\"n\" autoComplete=\"name\" />\n          </label>\n          <br />\n          <label htmlFor=\"email\">\n            Email\n            <input required type=\"email\" name=\"email\" autoComplete=\"email\" />\n          </label>\n          <br />\n          <label htmlFor=\"photo\">\n            Profile picture\n            <input\n              type=\"file\"\n              id=\"img\"\n              name=\"photo\"\n              accept=\"image/*\"\n              onChange={handleUpload}\n            />\n          </label>\n          {image ? (\n            <ProfilePicture>\n              <img src={image} alt=\"user-uploaded profile image\" />\n            </ProfilePicture>\n          ) : null}\n          <br />\n        <button type=\"submit\">Add Child</button>\n      </form>\n    </Main>\n  );\n};\n\nexport default Child;"],"sourceRoot":""}